{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/user/GitHub/remotesports/client/src/pages/auth/RegisterComplete.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { auth, db, storage } from \"../../firebase\";\nimport { toast } from \"react-toastify\";\nimport { Button } from \"antd\";\nimport { CheckOutlined } from \"@ant-design/icons\";\nimport \"../../css/RegisterComplete.css\";\nimport { CountryDropdown, RegionDropdown } from \"react-country-region-selector\";\nimport PhoneInput from \"react-phone-number-input\";\nimport \"react-phone-number-input/style.css\";\n\nconst RegisterComplete = ({\n  history\n}) => {\n  _s();\n\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [country, selectCountry] = useState(\"\");\n  const [region, selectRegion] = useState(\"\");\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\n  const [isTeacher, setIsTeacher] = useState(\"\");\n  const [school, setSchool] = useState(\"\");\n  const [file, setFile] = useState(null);\n  const [url, setURL] = useState(\"\");\n  useEffect(() => {\n    setEmail(window.localStorage.getItem(\"emailForRegistration\"));\n  }, []);\n\n  function handleChange(e) {\n    setFile(e.target.files[0]);\n  }\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    if (!email || !password || !name) {\n      toast.error(\"You forgot some details!\");\n      return;\n    }\n\n    if (password.length < 6) {\n      toast.error(\"Password must contain at least 6 characters!\");\n      return;\n    }\n\n    try {\n      const result = await auth.signInWithEmailLink(email, window.location.href);\n\n      if (result.user.emailVerified) {\n        // remover o email da local storage\n        window.localStorage.removeItem(\"emailForRegistration\"); // receber o token do id utilizador\n\n        let user = auth.currentUser;\n        await user.updatePassword(password);\n        toast.success(`ðŸ¤ª Excellent! You complete your registration! Welcome to RemoteSports!`, {\n          position: \"top-right\",\n          autoClose: 5000,\n          hideProgressBar: true,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined\n        });\n        const uploadTask = storage.ref(`/images/${auth.currentUser.uid}/profileImage`).put(file);\n        uploadTask.on(\"state_changed\", console.log, console.error, () => {\n          storage.ref(\"images\").child(auth.currentUser.uid).child('profileImage').getDownloadURL().then(url => {\n            setFile(null);\n            setURL(url);\n          });\n        });\n        db.collection(\"users\").doc(auth.currentUser.uid).set({\n          email: email,\n          name: name,\n          country: country,\n          region: region,\n          phoneNumber: phoneNumber,\n          isTeacher: isTeacher,\n          school: school\n        }).then(function () {\n          console.log(\"Document successfully written!\");\n        }).catch(function (error) {\n          console.error(\"Error writing document: \", error);\n          toast.error(error);\n        });\n        history.push(\"/mainpage\");\n      }\n    } catch (error) {\n      toast.error(`ðŸ˜¥ ${error}`, {\n        position: \"top-right\",\n        autoClose: 5000,\n        hideProgressBar: true,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined\n      });\n      return;\n    }\n  };\n\n  const completeRegistrationForm = () => /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      children: \"Profile Image\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      onChange: handleChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"email\",\n      className: \"form-control\",\n      value: email,\n      readOnly: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"password\",\n      className: \"form-control\",\n      value: password,\n      onChange: e => setPassword(e.target.value),\n      placeholder: \"Password\",\n      autoFocus: true,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      className: \"form-control\",\n      value: name,\n      onChange: e => setName(e.target.value),\n      placeholder: \"Name\",\n      autoFocus: true,\n      required: \"true\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CountryDropdown, {\n      className: \"form-control\",\n      value: country,\n      onChange: selectCountry,\n      style: {\n        fontSize: 15\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(RegionDropdown, {\n      className: \"form-control\",\n      disableWhenEmpty: true,\n      country: country,\n      value: region,\n      onChange: selectRegion,\n      style: {\n        fontSize: 15\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PhoneInput, {\n      international: true,\n      defaultCountry: \"PT\",\n      value: phoneNumber,\n      onChange: setPhoneNumber\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n      onChange: e => setIsTeacher(e.target.value),\n      className: \"form-control\",\n      required: true,\n      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n        value: true,\n        children: \"Teacher\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n        value: false,\n        children: \"Student\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      className: \"form-control\",\n      value: school,\n      onChange: e => setSchool(e.target.value),\n      placeholder: \"School\",\n      autoFocus: true,\n      required: \"false\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: handleSubmit,\n      type: \"primary\",\n      className: \"mb-3\",\n      shape: \"round\",\n      block: true,\n      icon: /*#__PURE__*/_jsxDEV(CheckOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 15\n      }, this),\n      size: \"large\",\n      disabled: !email || !password || !country,\n      children: \"Finish your Registration\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 5\n  }, this);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"wrapper\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container p-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-6 offset-md-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Complete your Registration\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 13\n          }, this), completeRegistrationForm()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 204,\n    columnNumber: 5\n  }, this);\n};\n\n_s(RegisterComplete, \"h+rqjbqLslfXT2/l6Sj60JU77z8=\");\n\n_c = RegisterComplete;\nexport default RegisterComplete;\n\nvar _c;\n\n$RefreshReg$(_c, \"RegisterComplete\");","map":{"version":3,"sources":["/Users/user/GitHub/remotesports/client/src/pages/auth/RegisterComplete.js"],"names":["React","useEffect","useState","auth","db","storage","toast","Button","CheckOutlined","CountryDropdown","RegionDropdown","PhoneInput","RegisterComplete","history","email","setEmail","password","setPassword","name","setName","country","selectCountry","region","selectRegion","phoneNumber","setPhoneNumber","isTeacher","setIsTeacher","school","setSchool","file","setFile","url","setURL","window","localStorage","getItem","handleChange","e","target","files","handleSubmit","preventDefault","error","length","result","signInWithEmailLink","location","href","user","emailVerified","removeItem","currentUser","updatePassword","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","uploadTask","ref","uid","put","on","console","log","child","getDownloadURL","then","collection","doc","set","catch","push","completeRegistrationForm","value","fontSize"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { auth, db, storage } from \"../../firebase\";\nimport { toast } from \"react-toastify\";\nimport { Button } from \"antd\";\nimport { CheckOutlined } from \"@ant-design/icons\";\nimport \"../../css/RegisterComplete.css\";\nimport { CountryDropdown, RegionDropdown } from \"react-country-region-selector\";\nimport PhoneInput from \"react-phone-number-input\";\nimport \"react-phone-number-input/style.css\";\n\nconst RegisterComplete = ({ history }) => {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [country, selectCountry] = useState(\"\");\n  const [region, selectRegion] = useState(\"\");\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\n  const [isTeacher, setIsTeacher] = useState(\"\");\n  const [school, setSchool] = useState(\"\");\n  const [file, setFile] = useState(null);\n  const [url, setURL] = useState(\"\");\n\n  useEffect(() => {\n    setEmail(window.localStorage.getItem(\"emailForRegistration\"));\n  }, []);\n\n  function handleChange(e) {\n    setFile(e.target.files[0]);\n  }\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!email || !password || !name) {\n      toast.error(\"You forgot some details!\");\n      return;\n    }\n\n    if (password.length < 6) {\n      toast.error(\"Password must contain at least 6 characters!\");\n      return;\n    }\n\n    try {\n      const result = await auth.signInWithEmailLink(\n        email,\n        window.location.href\n      );\n\n      if (result.user.emailVerified) {\n        // remover o email da local storage\n\n        window.localStorage.removeItem(\"emailForRegistration\");\n\n        // receber o token do id utilizador\n\n        let user = auth.currentUser;\n        await user.updatePassword(password);\n\n        toast.success(\n          `ðŸ¤ª Excellent! You complete your registration! Welcome to RemoteSports!`,\n          {\n            position: \"top-right\",\n            autoClose: 5000,\n            hideProgressBar: true,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n          }\n        );\n\n        const uploadTask = storage\n          .ref(`/images/${auth.currentUser.uid}/profileImage`)\n          .put(file);\n        uploadTask.on(\"state_changed\", console.log, console.error, () => {\n          storage\n            .ref(\"images\")\n            .child(auth.currentUser.uid).child('profileImage')\n            .getDownloadURL()\n            .then((url) => {\n              setFile(null);\n              setURL(url);\n            });\n        });\n\n        db.collection(\"users\")\n          .doc(auth.currentUser.uid)\n          .set({\n            email: email,\n            name: name,\n            country: country,\n            region: region,\n            phoneNumber: phoneNumber,\n            isTeacher: isTeacher,\n            school: school,\n          })\n          .then(function () {\n            console.log(\"Document successfully written!\");\n          })\n          .catch(function (error) {\n            console.error(\"Error writing document: \", error);\n            toast.error(error);\n          });\n\n        history.push(\"/mainpage\");\n      }\n    } catch (error) {\n      toast.error(`ðŸ˜¥ ${error}`, {\n        position: \"top-right\",\n        autoClose: 5000,\n        hideProgressBar: true,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined,\n      });\n      return;\n    }\n  };\n\n  const completeRegistrationForm = () => (\n    <form onSubmit={handleSubmit}>\n      <label>Profile Image</label>\n      <input type=\"file\" onChange={handleChange} />\n      <br />\n      <br />\n      <input type=\"email\" className=\"form-control\" value={email} readOnly />\n      <br />\n      <input\n        type=\"password\"\n        className=\"form-control\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n        placeholder=\"Password\"\n        autoFocus\n        required\n      />\n      <br />\n      <input\n        type=\"text\"\n        className=\"form-control\"\n        value={name}\n        onChange={(e) => setName(e.target.value)}\n        placeholder=\"Name\"\n        autoFocus\n        required=\"true\"\n      />\n      <br />\n      <CountryDropdown\n      className=\"form-control\"\n        value={country}\n        onChange={selectCountry}\n        style={{ fontSize: 15 }}\n      />\n      <br />\n      <RegionDropdown\n      className=\"form-control\"\n        disableWhenEmpty={true}\n        country={country}\n        value={region}\n        onChange={selectRegion}\n        style={{ fontSize: 15 }}\n      />\n      <br />\n      <PhoneInput\n        international\n        defaultCountry=\"PT\"\n        value={phoneNumber}\n        onChange={setPhoneNumber}\n      />\n      <br />\n      <select onChange={(e) => setIsTeacher(e.target.value)} className=\"form-control\" required>\n        <option value={true}>Teacher</option>\n        <option value={false}>Student</option>\n      </select>\n      <br />\n      <input\n        type=\"text\"\n        className=\"form-control\"\n        value={school}\n        onChange={(e) => setSchool(e.target.value)}\n        placeholder=\"School\"\n        autoFocus\n        required=\"false\"\n      />\n      <br />\n      <Button\n        onClick={handleSubmit}\n        type=\"primary\"\n        className=\"mb-3\"\n        shape=\"round\"\n        block\n        icon={<CheckOutlined />}\n        size=\"large\"\n        disabled={!email || !password || !country}\n      >\n        Finish your Registration\n      </Button>\n    </form>\n  );\n\n  return (\n    <div className=\"wrapper\">\n      <div className=\"container p-5\">\n        <div className=\"row\">\n          <div className=\"col-md-6 offset-md-3\">\n            <h3>Complete your Registration</h3>\n            {completeRegistrationForm()}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default RegisterComplete;\n"]},"metadata":{},"sourceType":"module"}