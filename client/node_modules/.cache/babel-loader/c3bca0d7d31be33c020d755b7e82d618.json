{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _toConsumableArray from\"/Users/user/GitHub/remotesports/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/user/GitHub/remotesports/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/user/GitHub/remotesports/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/user/GitHub/remotesports/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/user/GitHub/remotesports/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/user/GitHub/remotesports/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/user/GitHub/remotesports/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import io from\"socket.io-client\";import{toast}from\"react-toastify\";import{auth,db}from\"../firebase\";import{IconButton,Badge,Input,Button}from\"@material-ui/core\";import VideocamIcon from\"@material-ui/icons/Videocam\";import VideocamOffIcon from\"@material-ui/icons/VideocamOff\";import MicIcon from\"@material-ui/icons/Mic\";import MicOffIcon from\"@material-ui/icons/MicOff\";import ScreenShareIcon from\"@material-ui/icons/ScreenShare\";import StopScreenShareIcon from\"@material-ui/icons/StopScreenShare\";import CallEndIcon from\"@material-ui/icons/CallEnd\";import ChatIcon from\"@material-ui/icons/Chat\";import{message}from\"antd\";import\"antd/dist/antd.css\";import{Row}from\"reactstrap\";import Modal from\"react-bootstrap/Modal\";import\"bootstrap/dist/css/bootstrap.css\";import\"../css/Room.css\";var server_url=\"http://localhost:8000\";var connections={};var peerConnectionConfig={iceServers:[// { 'urls': 'stun:stun.services.mozilla.com' },\n{urls:\"stun:stun.l.google.com:19302\"}]};var socket=null;var socketId=null;var elms=0;var Room=/*#__PURE__*/function(_Component){_inherits(Room,_Component);var _super=_createSuper(Room);function Room(props){var _this;_classCallCheck(this,Room);_this=_super.call(this,props);_this.getUsername=function(){if(auth.currentUser){db.collection(\"users\").doc(auth.currentUser.uid).get().then(function(doc){if(doc.exists){this.setState({username:doc.data().name});return false;}}).catch(function(error){console.log(error.message);});}else{return true;}};_this.getPermissions=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return navigator.mediaDevices.getUserMedia({video:true}).then(function(){return _this.videoAvailable=true;}).catch(function(){return _this.videoAvailable=false;});case 3:_context.next=5;return navigator.mediaDevices.getUserMedia({audio:true}).then(function(){return _this.audioAvailable=true;}).catch(function(){return _this.audioAvailable=false;});case 5:if(navigator.mediaDevices.getDisplayMedia){_this.setState({screenAvailable:true});}else{_this.setState({screenAvailable:false});}if(_this.videoAvailable||_this.audioAvailable){navigator.mediaDevices.getUserMedia({video:_this.videoAvailable,audio:_this.audioAvailable}).then(function(stream){window.localStream=stream;_this.localVideoref.current.srcObject=stream;}).then(function(stream){}).catch(function(e){return console.log(e);});}_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));_this.getMedia=function(){// Primeira função a ser lida\n// Tentamos ir buscar o video e audio do utilizador\n_this.setState({video:_this.videoAvailable,audio:_this.audioAvailable},function(){_this.getUserMedia();//atribuir media ao utilizador\n_this.connectToSocketServer();// conecção a sala\n});};_this.getUserMedia=function(){if(_this.state.video&&_this.videoAvailable||_this.state.audio&&_this.audioAvailable){// se conseguirmos atribuir a media e audio ao utilizador\nnavigator.mediaDevices.getUserMedia({video:_this.state.video,audio:_this.state.audio}).then(_this.getUserMediaSuccess).then(function(stream){}).catch(function(e){return console.log(e);});}else{try{var tracks=_this.localVideoref.current.srcObject.getTracks();tracks.forEach(function(track){return track.stop();});}catch(e){}}};_this.getUserMediaSuccess=function(stream){try{window.localStream.getTracks().forEach(function(track){return track.stop();});}catch(e){console.log(e);}window.localStream=stream;_this.localVideoref.current.srcObject=stream;var _loop=function _loop(id){if(id===socketId)return\"continue\";connections[id].addStream(window.localStream);connections[id].createOffer().then(function(description){connections[id].setLocalDescription(description).then(function(){socket.emit(\"signal\",id,JSON.stringify({sdp:connections[id].localDescription}));}).catch(function(e){return console.log(e);});});};for(var id in connections){var _ret=_loop(id);if(_ret===\"continue\")continue;}stream.getTracks().forEach(function(track){return track.onended=function(){_this.setState({video:false,audio:false},function(){try{var tracks=_this.localVideoref.current.srcObject.getTracks();tracks.forEach(function(track){return track.stop();});}catch(e){console.log(e);}var blackSilence=function blackSilence(){var _this2;return new MediaStream([(_this2=_this).black.apply(_this2,arguments),_this.silence()]);};window.localStream=blackSilence();_this.localVideoref.current.srcObject=window.localStream;var _loop2=function _loop2(_id){connections[_id].addStream(window.localStream);connections[_id].createOffer().then(function(description){connections[_id].setLocalDescription(description).then(function(){socket.emit(\"signal\",_id,JSON.stringify({sdp:connections[_id].localDescription}));}).catch(function(e){return console.log(e);});});};for(var _id in connections){_loop2(_id);}});};});};_this.getDislayMedia=function(){//media a ser \"displayed\" do utilizador\nif(_this.state.screen){if(navigator.mediaDevices.getDisplayMedia){navigator.mediaDevices.getDisplayMedia({video:true,audio:true}).then(_this.getDislayMediaSuccess).then(function(stream){}).catch(function(e){return console.log(e);});}}};_this.getDislayMediaSuccess=function(stream){try{window.localStream.getTracks().forEach(function(track){return track.stop();});}catch(e){console.log(e);}window.localStream=stream;_this.localVideoref.current.srcObject=stream;var _loop3=function _loop3(id){if(id===socketId)return\"continue\";connections[id].addStream(window.localStream);//adicionar a stream do utilizador\nconnections[id].createOffer().then(function(description){connections[id].setLocalDescription(description).then(function(){socket.emit(\"signal\",id,JSON.stringify({sdp:connections[id].localDescription}));}).catch(function(e){return console.log(e);});});};for(var id in connections){var _ret2=_loop3(id);if(_ret2===\"continue\")continue;}stream.getTracks().forEach(function(track){return track.onended=function(){_this.setState({screen:false},function(){try{var tracks=_this.localVideoref.current.srcObject.getTracks();tracks.forEach(function(track){return track.stop();});}catch(e){console.log(e);}var blackSilence=function blackSilence(){var _this3;return new MediaStream([(_this3=_this).black.apply(_this3,arguments),_this.silence()]);};window.localStream=blackSilence();_this.localVideoref.current.srcObject=window.localStream;_this.getUserMedia();});};});};_this.gotMessageFromServer=function(fromId,message){var signal=JSON.parse(message);if(fromId!==socketId){if(signal.sdp){connections[fromId].setRemoteDescription(new RTCSessionDescription(signal.sdp)).then(function(){if(signal.sdp.type===\"offer\"){connections[fromId].createAnswer().then(function(description){connections[fromId].setLocalDescription(description).then(function(){socket.emit(\"signal\",fromId,JSON.stringify({sdp:connections[fromId].localDescription}));}).catch(function(e){return console.log(e);});}).catch(function(e){return console.log(e);});}}).catch(function(e){return console.log(e);});}if(signal.ice){connections[fromId].addIceCandidate(new RTCIceCandidate(signal.ice)).catch(function(e){return console.log(e);});}}};_this.changeCssVideos=function(main){var widthMain=main.offsetWidth;var minWidth=\"30%\";if(widthMain*30/100<300){minWidth=\"300px\";}var minHeight=\"40%\";var height=String(100/elms)+\"%\";var width=\"\";if(elms===0||elms===1){width=\"100%\";height=\"100%\";}else if(elms===2){width=\"45%\";height=\"100%\";}else if(elms===3||elms===4){width=\"35%\";height=\"50%\";}else{width=String(100/elms)+\"%\";}var videos=main.querySelectorAll(\"video\");for(var a=0;a<videos.length;++a){videos[a].style.minWidth=minWidth;videos[a].style.minHeight=minHeight;videos[a].style.setProperty(\"width\",width);videos[a].style.setProperty(\"height\",height);}return{minWidth:minWidth,minHeight:minHeight,width:width,height:height};};_this.connectToSocketServer=function(){socket=io.connect(server_url,{secure:true});socket.on(\"signal\",_this.gotMessageFromServer);socket.on(\"connect\",function(){socket.emit(\"join-call\",window.location.href);socketId=socket.id;socket.on(\"chat-message\",_this.addMessage);socket.on(\"user-left\",function(id){var video=document.querySelector(\"[data-socket=\\\"\".concat(id,\"\\\"]\"));if(video!==null){elms--;video.parentNode.removeChild(video);var main=document.getElementById(\"main\");_this.changeCssVideos(main);}});socket.on(\"user-joined\",function(id,clients){clients.forEach(function(socketListId){connections[socketListId]=new RTCPeerConnection(peerConnectionConfig);// Wait for their ice candidate\nconnections[socketListId].onicecandidate=function(event){if(event.candidate!=null){socket.emit(\"signal\",socketListId,JSON.stringify({ice:event.candidate}));}};// Wait for their video stream\nconnections[socketListId].onaddstream=function(event){// TODO mute button, full screen button\nvar searchVidep=document.querySelector(\"[data-socket=\\\"\".concat(socketListId,\"\\\"]\"));if(searchVidep!==null){// if i don't do this check it make an empyt square\nsearchVidep.srcObject=event.stream;}else{elms=clients.length;var main=document.getElementById(\"main\");var cssMesure=_this.changeCssVideos(main);var video=document.createElement(\"video\");var css={minWidth:cssMesure.minWidth,minHeight:cssMesure.minHeight,maxHeight:\"100%\",margin:\"10px\",borderStyle:\"solid\",borderColor:\"#bdbdbd\",objectFit:\"fill\"};for(var i in css){video.style[i]=css[i];}video.style.setProperty(\"width\",cssMesure.width);video.style.setProperty(\"height\",cssMesure.height);video.setAttribute(\"data-socket\",socketListId);video.srcObject=event.stream;video.autoplay=true;video.playsinline=true;main.appendChild(video);}};// Add the local video stream\nif(window.localStream!==undefined&&window.localStream!==null){connections[socketListId].addStream(window.localStream);}else{var blackSilence=function blackSilence(){var _this4;return new MediaStream([(_this4=_this).black.apply(_this4,arguments),_this.silence()]);};window.localStream=blackSilence();connections[socketListId].addStream(window.localStream);}});if(id===socketId){var _loop4=function _loop4(id2){if(id2===socketId)return\"continue\";try{connections[id2].addStream(window.localStream);}catch(e){}connections[id2].createOffer().then(function(description){connections[id2].setLocalDescription(description).then(function(){socket.emit(\"signal\",id2,JSON.stringify({sdp:connections[id2].localDescription}));}).catch(function(e){return console.log(e);});});};for(var id2 in connections){var _ret3=_loop4(id2);if(_ret3===\"continue\")continue;}}});});};_this.silence=function(){var ctx=new AudioContext();var oscillator=ctx.createOscillator();var dst=oscillator.connect(ctx.createMediaStreamDestination());oscillator.start();ctx.resume();return Object.assign(dst.stream.getAudioTracks()[0],{enabled:false});};_this.black=function(){var _ref2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref2$width=_ref2.width,width=_ref2$width===void 0?640:_ref2$width,_ref2$height=_ref2.height,height=_ref2$height===void 0?480:_ref2$height;var canvas=Object.assign(document.createElement(\"canvas\"),{width:width,height:height});canvas.getContext(\"2d\").fillRect(0,0,width,height);var stream=canvas.captureStream();return Object.assign(stream.getVideoTracks()[0],{enabled:false});};_this.handleVideo=function(){return _this.setState({video:!_this.state.video},function(){return _this.getUserMedia();});};_this.handleAudio=function(){return _this.setState({audio:!_this.state.audio},function(){return _this.getUserMedia();});};_this.handleScreen=function(){return _this.setState({screen:!_this.state.screen},function(){return _this.getDislayMedia();});};_this.handleEndCall=function(){try{var tracks=_this.localVideoref.current.srcObject.getTracks();tracks.forEach(function(track){return track.stop();});toast.error(\"You leave the Meeting!\",{position:\"top-right\",autoClose:5000,hideProgressBar:true,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});}catch(e){}window.location.href=\"/\";};_this.openChat=function(){return _this.setState({showModal:true,newmessages:0});};_this.closeChat=function(){return _this.setState({showModal:false});};_this.handleMessage=function(e){return _this.setState({message:e.target.value});};_this.addMessage=function(data,sender,socketIdSender){_this.setState(function(prevState){return{messages:[].concat(_toConsumableArray(prevState.messages),[{sender:sender,data:data}])};});if(socketIdSender!==socketId){_this.setState({newmessages:_this.state.newmessages+1});}};_this.handleUsername=function(e){return _this.setState({username:e.target.value});};_this.sendMessage=function(){socket.emit(\"chat-message\",_this.state.message,_this.state.username);_this.setState({message:\"\",sender:_this.state.username});};_this.copyUrl=function(){var text=window.location.href;if(!navigator.clipboard){var textArea=document.createElement(\"textarea\");textArea.value=text;document.body.appendChild(textArea);textArea.focus();textArea.select();try{document.execCommand(\"copy\");message.success(\"Link copied to clipboard!\");}catch(err){message.error(\"Failed to copy\");}document.body.removeChild(textArea);return;}navigator.clipboard.writeText(text).then(function(){message.success(\"Link copied to clipboard!\");},function(){message.error(\"Failed to copy\");});};_this.enumerateDevicesFunction=function(){var select1=document.getElementById(\"select1\");var select3=document.getElementById(\"select3\");navigator.mediaDevices.enumerateDevices().then(function(devices){devices.forEach(function(deviceInfo){var option=document.createElement(\"option\");option.value=deviceInfo.deviceId;if(deviceInfo.kind===\"audioinput\"){console.log(deviceInfo.label);option.label=deviceInfo.label;option.value=deviceInfo.deviceId;//  console.log(option.value);\nselect1.appendChild(option);}else if(deviceInfo.kind===\"videoinput\"){option.label=deviceInfo.label;option.value=deviceInfo.deviceId;//  console.log(option.value);\nselect3.appendChild(option);}});}).catch(function(err){console.log(err.name+\": \"+err.message);});};_this.connect=function(){return _this.setState({askForUsername:false},function(){return _this.getMedia();});};_this.isChrome=function(){var userAgent=(navigator&&(navigator.userAgent||\"\")).toLowerCase();var vendor=(navigator&&(navigator.vendor||\"\")).toLowerCase();var matchChrome=/google inc/.test(vendor)?userAgent.match(/(?:chrome|crios)\\/(\\d+)/):null;// let matchFirefox = userAgent.match(/(?:firefox|fxios)\\/(\\d+)/)\n// return matchChrome !== null || matchFirefox !== null\nreturn matchChrome!==null;};_this.enumerateDevicesFunction();_this.localVideoref=/*#__PURE__*/React.createRef();_this.videoAvailable=false;_this.audioAvailable=false;_this.state={video:false,audio:false,screen:false,showModal:false,screenAvailable:false,messages:[],message:\"\",newmessages:0,askForUsername:_this.getUsername(),username:\"\"};connections={};_this.getPermissions();return _this;}// Obter o Nome de Utilizador\n_createClass(Room,[{key:\"render\",value:function render(){var _this5=this;if(this.isChrome()===false){return/*#__PURE__*/_jsx(\"div\",{style:{background:\"white\",width:\"30%\",height:\"auto\",padding:\"20px\",minWidth:\"400px\",textAlign:\"center\",margin:\"auto\",marginTop:\"50px\",justifyContent:\"center\"},children:/*#__PURE__*/_jsx(\"h1\",{children:\"Sorry, this works only with Google Chrome\"})});}return/*#__PURE__*/_jsx(\"div\",{children:this.state.askForUsername===true?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:\"white\",width:\"30%\",height:\"auto\",padding:\"20px\",minWidth:\"400px\",textAlign:\"center\",margin:\"auto\",marginTop:\"50px\",justifyContent:\"center\"},children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:0,fontWeight:\"bold\",paddingRight:\"50px\"},children:\"Set your username\"}),/*#__PURE__*/_jsx(Input,{placeholder:\"Username\",required:true,value:this.state.username,onChange:function onChange(e){return _this5.handleUsername(e);}}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:this.connect,disabled:!this.state.username,style:{margin:\"20px\"},children:\"Connect\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{justifyContent:\"center\",textAlign:\"center\",paddingTop:\"40px\"},children:/*#__PURE__*/_jsx(\"video\",{id:\"my-video\",ref:this.localVideoref,autoPlay:true,muted:true,style:{borderStyle:\"solid\",borderColor:\"#bdbdbd\",objectFit:\"fill\",width:\"60%\",height:\"30%\"}})})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"btn-down\",style:{backgroundColor:\"whitesmoke\",color:\"whitesmoke\",textAlign:\"center\"},children:[/*#__PURE__*/_jsx(IconButton,{style:{color:\"#424242\"},onClick:this.handleVideo,children:this.state.video===true?/*#__PURE__*/_jsx(VideocamIcon,{}):/*#__PURE__*/_jsx(VideocamOffIcon,{})}),/*#__PURE__*/_jsx(IconButton,{style:{color:\"#f44336\"},onClick:this.handleEndCall,children:/*#__PURE__*/_jsx(CallEndIcon,{})}),/*#__PURE__*/_jsx(IconButton,{style:{color:\"#424242\"},onClick:this.handleAudio,children:this.state.audio===true?/*#__PURE__*/_jsx(MicIcon,{}):/*#__PURE__*/_jsx(MicOffIcon,{})}),this.state.screenAvailable===true?/*#__PURE__*/_jsx(IconButton,{style:{color:\"#424242\"},onClick:this.handleScreen,children:this.state.screen===true?/*#__PURE__*/_jsx(ScreenShareIcon,{}):/*#__PURE__*/_jsx(StopScreenShareIcon,{})}):null,/*#__PURE__*/_jsx(Badge,{badgeContent:this.state.newmessages,max:999,color:\"secondary\",onClick:this.openChat,children:/*#__PURE__*/_jsx(IconButton,{style:{color:\"#424242\"},onClick:this.openChat,children:/*#__PURE__*/_jsx(ChatIcon,{})})})]}),/*#__PURE__*/_jsxs(Modal,{show:this.state.showModal,onHide:this.closeChat,style:{zIndex:\"999999\"},children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Chat Room\"})}),/*#__PURE__*/_jsx(Modal.Body,{style:{overflow:\"auto\",overflowY:\"auto\",height:\"400px\",textAlign:\"left\"},children:this.state.messages.length>0?this.state.messages.map(function(item,index){return/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"left\"},children:/*#__PURE__*/_jsxs(\"p\",{style:{wordBreak:\"break-all\"},children:[/*#__PURE__*/_jsx(\"b\",{children:item.sender}),\": \",item.data]})},index);}):/*#__PURE__*/_jsx(\"p\",{children:\"No messages yet\"})}),/*#__PURE__*/_jsxs(Modal.Footer,{className:\"div-send-msg\",children:[/*#__PURE__*/_jsx(Input,{placeholder:\"Message\",value:this.state.message,onChange:function onChange(e){return _this5.handleMessage(e);}}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:this.sendMessage,children:\"Send\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{paddingTop:\"20px\"},children:[/*#__PURE__*/_jsx(Input,{value:window.location.href,disable:\"true\"}),/*#__PURE__*/_jsx(Button,{style:{backgroundColor:\"#3f51b5\",color:\"whitesmoke\",marginLeft:\"20px\",marginTop:\"10px\",width:\"120px\",fontSize:\"10px\"},onClick:this.copyUrl,children:\"Copy invite link\"}),\" \",/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-4 pb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{for:\"select1\",children:\"Audio Source: \"}),/*#__PURE__*/_jsx(\"select\",{id:\"select1\",className:\"pr-3\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{for:\"select3\",children:\"Video Source: \"}),/*#__PURE__*/_jsx(\"select\",{id:\"select3\",className:\"pr-3\"}),this.enumerateDevicesFunction()]})]}),/*#__PURE__*/_jsx(Row,{id:\"main\",className:\"flex-container\",style:{margin:0,padding:0},children:/*#__PURE__*/_jsx(\"video\",{id:\"my-video\",ref:this.localVideoref,autoPlay:true,muted:true,style:{borderStyle:\"solid\",borderColor:\"#bdbdbd\",margin:\"10px\",objectFit:\"fill\",width:\"100%\",height:\"100%\"}})})]})]})});}}]);return Room;}(Component);export default Room;","map":{"version":3,"sources":["/Users/user/GitHub/remotesports/client/src/pages/Room.js"],"names":["React","Component","io","toast","auth","db","IconButton","Badge","Input","Button","VideocamIcon","VideocamOffIcon","MicIcon","MicOffIcon","ScreenShareIcon","StopScreenShareIcon","CallEndIcon","ChatIcon","message","Row","Modal","server_url","connections","peerConnectionConfig","iceServers","urls","socket","socketId","elms","Room","props","getUsername","currentUser","collection","doc","uid","get","then","exists","setState","username","data","name","catch","error","console","log","getPermissions","navigator","mediaDevices","getUserMedia","video","videoAvailable","audio","audioAvailable","getDisplayMedia","screenAvailable","stream","window","localStream","localVideoref","current","srcObject","e","getMedia","connectToSocketServer","state","getUserMediaSuccess","tracks","getTracks","forEach","track","stop","id","addStream","createOffer","description","setLocalDescription","emit","JSON","stringify","sdp","localDescription","onended","blackSilence","MediaStream","black","silence","getDislayMedia","screen","getDislayMediaSuccess","gotMessageFromServer","fromId","signal","parse","setRemoteDescription","RTCSessionDescription","type","createAnswer","ice","addIceCandidate","RTCIceCandidate","changeCssVideos","main","widthMain","offsetWidth","minWidth","minHeight","height","String","width","videos","querySelectorAll","a","length","style","setProperty","connect","secure","on","location","href","addMessage","document","querySelector","parentNode","removeChild","getElementById","clients","socketListId","RTCPeerConnection","onicecandidate","event","candidate","onaddstream","searchVidep","cssMesure","createElement","css","maxHeight","margin","borderStyle","borderColor","objectFit","i","setAttribute","autoplay","playsinline","appendChild","undefined","id2","ctx","AudioContext","oscillator","createOscillator","dst","createMediaStreamDestination","start","resume","Object","assign","getAudioTracks","enabled","canvas","getContext","fillRect","captureStream","getVideoTracks","handleVideo","handleAudio","handleScreen","handleEndCall","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","openChat","showModal","newmessages","closeChat","handleMessage","target","value","sender","socketIdSender","prevState","messages","handleUsername","sendMessage","copyUrl","text","clipboard","textArea","body","focus","select","execCommand","success","err","writeText","enumerateDevicesFunction","select1","select3","enumerateDevices","devices","deviceInfo","option","deviceId","kind","label","askForUsername","isChrome","userAgent","toLowerCase","vendor","matchChrome","test","match","createRef","background","padding","textAlign","marginTop","justifyContent","fontWeight","paddingRight","paddingTop","backgroundColor","color","zIndex","overflow","overflowY","map","item","index","wordBreak","marginLeft","fontSize"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport io from \"socket.io-client\";\nimport { toast } from \"react-toastify\";\n\nimport { auth, db } from \"../firebase\";\n\nimport { IconButton, Badge, Input, Button } from \"@material-ui/core\";\nimport VideocamIcon from \"@material-ui/icons/Videocam\";\nimport VideocamOffIcon from \"@material-ui/icons/VideocamOff\";\nimport MicIcon from \"@material-ui/icons/Mic\";\nimport MicOffIcon from \"@material-ui/icons/MicOff\";\nimport ScreenShareIcon from \"@material-ui/icons/ScreenShare\";\nimport StopScreenShareIcon from \"@material-ui/icons/StopScreenShare\";\nimport CallEndIcon from \"@material-ui/icons/CallEnd\";\nimport ChatIcon from \"@material-ui/icons/Chat\";\n\nimport { message } from \"antd\";\nimport \"antd/dist/antd.css\";\n\nimport { Row } from \"reactstrap\";\nimport Modal from \"react-bootstrap/Modal\";\nimport \"bootstrap/dist/css/bootstrap.css\";\n\nimport \"../css/Room.css\";\n\nconst server_url = \"http://localhost:8000\";\n\nvar connections = {};\nconst peerConnectionConfig = {\n  iceServers: [\n    // { 'urls': 'stun:stun.services.mozilla.com' },\n    { urls: \"stun:stun.l.google.com:19302\" },\n  ],\n};\nvar socket = null;\nvar socketId = null;\nvar elms = 0;\n\nclass Room extends Component {\n  constructor(props) {\n    super(props);\n\n    this.enumerateDevicesFunction();\n\n    this.localVideoref = React.createRef();\n\n    this.videoAvailable = false;\n    this.audioAvailable = false;\n\n    this.state = {\n      video: false,\n      audio: false,\n      screen: false,\n      showModal: false,\n      screenAvailable: false,\n      messages: [],\n      message: \"\",\n      newmessages: 0,\n      askForUsername: this.getUsername(),\n      username: \"\",\n    };\n    connections = {};\n\n    this.getPermissions();\n  }\n\n  // Obter o Nome de Utilizador\n  getUsername = () => {\n    if (auth.currentUser) {\n      db.collection(\"users\")\n        .doc(auth.currentUser.uid)\n        .get()\n        .then(function (doc) {\n          if (doc.exists) {\n            this.setState({ username: doc.data().name });\n            return false;\n          }\n        })\n        .catch(function (error) {\n          console.log(error.message)\n        });\n    } else {\n      return true;\n    }\n  };\n\n  getPermissions = async () => {\n    try {\n      await navigator.mediaDevices\n        .getUserMedia({ video: true })\n        .then(() => (this.videoAvailable = true))\n        .catch(() => (this.videoAvailable = false));\n\n      await navigator.mediaDevices\n        .getUserMedia({ audio: true })\n        .then(() => (this.audioAvailable = true))\n        .catch(() => (this.audioAvailable = false));\n\n      if (navigator.mediaDevices.getDisplayMedia) {\n        this.setState({ screenAvailable: true });\n      } else {\n        this.setState({ screenAvailable: false });\n      }\n\n      if (this.videoAvailable || this.audioAvailable) {\n        navigator.mediaDevices\n          .getUserMedia({\n            video: this.videoAvailable,\n            audio: this.audioAvailable,\n          })\n          .then((stream) => {\n            window.localStream = stream;\n            this.localVideoref.current.srcObject = stream;\n          })\n          .then((stream) => {})\n          .catch((e) => console.log(e));\n      }\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  getMedia = () => {\n    // Primeira função a ser lida\n    // Tentamos ir buscar o video e audio do utilizador\n    this.setState(\n      {\n        video: this.videoAvailable,\n        audio: this.audioAvailable,\n      },\n      () => {\n        this.getUserMedia(); //atribuir media ao utilizador\n        this.connectToSocketServer(); // conecção a sala\n      }\n    );\n  };\n\n  getUserMedia = () => {\n    if (\n      (this.state.video && this.videoAvailable) ||\n      (this.state.audio && this.audioAvailable)\n    ) {\n      // se conseguirmos atribuir a media e audio ao utilizador\n      navigator.mediaDevices\n        .getUserMedia({ video: this.state.video, audio: this.state.audio })\n        .then(this.getUserMediaSuccess)\n        .then((stream) => {})\n        .catch((e) => console.log(e));\n    } else {\n      try {\n        let tracks = this.localVideoref.current.srcObject.getTracks();\n        tracks.forEach((track) => track.stop());\n      } catch (e) {}\n    }\n  };\n\n  getUserMediaSuccess = (stream) => {\n    try {\n      window.localStream.getTracks().forEach((track) => track.stop());\n    } catch (e) {\n      console.log(e);\n    }\n\n    window.localStream = stream;\n    this.localVideoref.current.srcObject = stream;\n\n    for (let id in connections) {\n      if (id === socketId) continue;\n\n      connections[id].addStream(window.localStream);\n\n      connections[id].createOffer().then((description) => {\n        connections[id]\n          .setLocalDescription(description)\n          .then(() => {\n            socket.emit(\n              \"signal\",\n              id,\n              JSON.stringify({ sdp: connections[id].localDescription })\n            );\n          })\n          .catch((e) => console.log(e));\n      });\n    }\n\n    stream.getTracks().forEach(\n      (track) =>\n        (track.onended = () => {\n          this.setState(\n            {\n              video: false,\n              audio: false,\n            },\n            () => {\n              try {\n                let tracks = this.localVideoref.current.srcObject.getTracks();\n                tracks.forEach((track) => track.stop());\n              } catch (e) {\n                console.log(e);\n              }\n\n              let blackSilence = (...args) =>\n                new MediaStream([this.black(...args), this.silence()]);\n              window.localStream = blackSilence();\n              this.localVideoref.current.srcObject = window.localStream;\n\n              for (let id in connections) {\n                connections[id].addStream(window.localStream);\n\n                connections[id].createOffer().then((description) => {\n                  connections[id]\n                    .setLocalDescription(description)\n                    .then(() => {\n                      socket.emit(\n                        \"signal\",\n                        id,\n                        JSON.stringify({\n                          sdp: connections[id].localDescription,\n                        })\n                      );\n                    })\n                    .catch((e) => console.log(e));\n                });\n              }\n            }\n          );\n        })\n    );\n  };\n\n  getDislayMedia = () => {\n    //media a ser \"displayed\" do utilizador\n    if (this.state.screen) {\n      if (navigator.mediaDevices.getDisplayMedia) {\n        navigator.mediaDevices\n          .getDisplayMedia({ video: true, audio: true })\n          .then(this.getDislayMediaSuccess)\n          .then((stream) => {})\n          .catch((e) => console.log(e));\n      }\n    }\n  };\n\n  getDislayMediaSuccess = (stream) => {\n    try {\n      window.localStream.getTracks().forEach((track) => track.stop());\n    } catch (e) {\n      console.log(e);\n    }\n\n    window.localStream = stream;\n    this.localVideoref.current.srcObject = stream;\n\n    for (let id in connections) {\n      if (id === socketId) continue;\n\n      connections[id].addStream(window.localStream); //adicionar a stream do utilizador\n\n      connections[id].createOffer().then((description) => {\n        connections[id]\n          .setLocalDescription(description)\n          .then(() => {\n            socket.emit(\n              \"signal\",\n              id,\n              JSON.stringify({ sdp: connections[id].localDescription })\n            );\n          })\n          .catch((e) => console.log(e));\n      });\n    }\n\n    stream.getTracks().forEach(\n      (track) =>\n        (track.onended = () => {\n          this.setState(\n            {\n              screen: false,\n            },\n            () => {\n              try {\n                let tracks = this.localVideoref.current.srcObject.getTracks();\n                tracks.forEach((track) => track.stop());\n              } catch (e) {\n                console.log(e);\n              }\n\n              let blackSilence = (...args) =>\n                new MediaStream([this.black(...args), this.silence()]);\n              window.localStream = blackSilence();\n              this.localVideoref.current.srcObject = window.localStream;\n\n              this.getUserMedia();\n            }\n          );\n        })\n    );\n  };\n\n  gotMessageFromServer = (fromId, message) => {\n    var signal = JSON.parse(message);\n\n    if (fromId !== socketId) {\n      if (signal.sdp) {\n        connections[fromId]\n          .setRemoteDescription(new RTCSessionDescription(signal.sdp))\n          .then(() => {\n            if (signal.sdp.type === \"offer\") {\n              connections[fromId]\n                .createAnswer()\n                .then((description) => {\n                  connections[fromId]\n                    .setLocalDescription(description)\n                    .then(() => {\n                      socket.emit(\n                        \"signal\",\n                        fromId,\n                        JSON.stringify({\n                          sdp: connections[fromId].localDescription,\n                        })\n                      );\n                    })\n                    .catch((e) => console.log(e));\n                })\n                .catch((e) => console.log(e));\n            }\n          })\n          .catch((e) => console.log(e));\n      }\n\n      if (signal.ice) {\n        connections[fromId]\n          .addIceCandidate(new RTCIceCandidate(signal.ice))\n          .catch((e) => console.log(e));\n      }\n    }\n  };\n\n  changeCssVideos = (main) => {\n    let widthMain = main.offsetWidth;\n    let minWidth = \"30%\";\n    if ((widthMain * 30) / 100 < 300) {\n      minWidth = \"300px\";\n    }\n    let minHeight = \"40%\";\n\n    let height = String(100 / elms) + \"%\";\n    let width = \"\";\n    if (elms === 0 || elms === 1) {\n      width = \"100%\";\n      height = \"100%\";\n    } else if (elms === 2) {\n      width = \"45%\";\n      height = \"100%\";\n    } else if (elms === 3 || elms === 4) {\n      width = \"35%\";\n      height = \"50%\";\n    } else {\n      width = String(100 / elms) + \"%\";\n    }\n\n    let videos = main.querySelectorAll(\"video\");\n    for (let a = 0; a < videos.length; ++a) {\n      videos[a].style.minWidth = minWidth;\n      videos[a].style.minHeight = minHeight;\n      videos[a].style.setProperty(\"width\", width);\n      videos[a].style.setProperty(\"height\", height);\n    }\n\n    return { minWidth, minHeight, width, height };\n  };\n\n  connectToSocketServer = () => {\n    socket = io.connect(server_url, { secure: true });\n\n    socket.on(\"signal\", this.gotMessageFromServer);\n\n    socket.on(\"connect\", () => {\n      socket.emit(\"join-call\", window.location.href);\n      socketId = socket.id;\n\n      socket.on(\"chat-message\", this.addMessage);\n\n      socket.on(\"user-left\", (id) => {\n        let video = document.querySelector(`[data-socket=\"${id}\"]`);\n        if (video !== null) {\n          elms--;\n          video.parentNode.removeChild(video);\n\n          let main = document.getElementById(\"main\");\n          this.changeCssVideos(main);\n        }\n      });\n\n      socket.on(\"user-joined\", (id, clients) => {\n        clients.forEach((socketListId) => {\n          connections[socketListId] = new RTCPeerConnection(\n            peerConnectionConfig\n          );\n          // Wait for their ice candidate\n          connections[socketListId].onicecandidate = function (event) {\n            if (event.candidate != null) {\n              socket.emit(\n                \"signal\",\n                socketListId,\n                JSON.stringify({ ice: event.candidate })\n              );\n            }\n          };\n\n          // Wait for their video stream\n          connections[socketListId].onaddstream = (event) => {\n            // TODO mute button, full screen button\n            var searchVidep = document.querySelector(\n              `[data-socket=\"${socketListId}\"]`\n            );\n            if (searchVidep !== null) {\n              // if i don't do this check it make an empyt square\n              searchVidep.srcObject = event.stream;\n            } else {\n              elms = clients.length;\n              let main = document.getElementById(\"main\");\n              let cssMesure = this.changeCssVideos(main);\n\n              let video = document.createElement(\"video\");\n\n              let css = {\n                minWidth: cssMesure.minWidth,\n                minHeight: cssMesure.minHeight,\n                maxHeight: \"100%\",\n                margin: \"10px\",\n                borderStyle: \"solid\",\n                borderColor: \"#bdbdbd\",\n                objectFit: \"fill\",\n              };\n              for (let i in css) video.style[i] = css[i];\n\n              video.style.setProperty(\"width\", cssMesure.width);\n              video.style.setProperty(\"height\", cssMesure.height);\n              video.setAttribute(\"data-socket\", socketListId);\n              video.srcObject = event.stream;\n              video.autoplay = true;\n              video.playsinline = true;\n\n              main.appendChild(video);\n            }\n          };\n\n          // Add the local video stream\n          if (window.localStream !== undefined && window.localStream !== null) {\n            connections[socketListId].addStream(window.localStream);\n          } else {\n            let blackSilence = (...args) =>\n              new MediaStream([this.black(...args), this.silence()]);\n            window.localStream = blackSilence();\n            connections[socketListId].addStream(window.localStream);\n          }\n        });\n\n        if (id === socketId) {\n          for (let id2 in connections) {\n            if (id2 === socketId) continue;\n\n            try {\n              connections[id2].addStream(window.localStream);\n            } catch (e) {}\n\n            connections[id2].createOffer().then((description) => {\n              connections[id2]\n                .setLocalDescription(description)\n                .then(() => {\n                  socket.emit(\n                    \"signal\",\n                    id2,\n                    JSON.stringify({ sdp: connections[id2].localDescription })\n                  );\n                })\n                .catch((e) => console.log(e));\n            });\n          }\n        }\n      });\n    });\n  };\n\n  silence = () => {\n    let ctx = new AudioContext();\n    let oscillator = ctx.createOscillator();\n    let dst = oscillator.connect(ctx.createMediaStreamDestination());\n    oscillator.start();\n    ctx.resume();\n    return Object.assign(dst.stream.getAudioTracks()[0], { enabled: false });\n  };\n  black = ({ width = 640, height = 480 } = {}) => {\n    let canvas = Object.assign(document.createElement(\"canvas\"), {\n      width,\n      height,\n    });\n    canvas.getContext(\"2d\").fillRect(0, 0, width, height);\n    let stream = canvas.captureStream();\n    return Object.assign(stream.getVideoTracks()[0], { enabled: false });\n  };\n\n  handleVideo = () =>\n    this.setState({ video: !this.state.video }, () => this.getUserMedia());\n  handleAudio = () =>\n    this.setState({ audio: !this.state.audio }, () => this.getUserMedia());\n  handleScreen = () =>\n    this.setState({ screen: !this.state.screen }, () => this.getDislayMedia());\n\n  handleEndCall = () => {\n    try {\n      let tracks = this.localVideoref.current.srcObject.getTracks();\n      tracks.forEach((track) => track.stop());\n      toast.error(\"You leave the Meeting!\", {\n        position: \"top-right\",\n        autoClose: 5000,\n        hideProgressBar: true,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined,\n      });\n    } catch (e) {}\n    window.location.href = \"/\";\n  };\n\n  openChat = () => this.setState({ showModal: true, newmessages: 0 });\n  closeChat = () => this.setState({ showModal: false });\n  handleMessage = (e) => this.setState({ message: e.target.value });\n\n  addMessage = (data, sender, socketIdSender) => {\n    this.setState((prevState) => ({\n      messages: [...prevState.messages, { sender: sender, data: data }],\n    }));\n    if (socketIdSender !== socketId) {\n      this.setState({ newmessages: this.state.newmessages + 1 });\n    }\n  };\n\n  handleUsername = (e) => this.setState({ username: e.target.value });\n\n  sendMessage = () => {\n    socket.emit(\"chat-message\", this.state.message, this.state.username);\n    this.setState({ message: \"\", sender: this.state.username });\n  };\n\n  copyUrl = () => {\n    let text = window.location.href;\n    if (!navigator.clipboard) {\n      let textArea = document.createElement(\"textarea\");\n      textArea.value = text;\n      document.body.appendChild(textArea);\n      textArea.focus();\n      textArea.select();\n      try {\n        document.execCommand(\"copy\");\n        message.success(\"Link copied to clipboard!\");\n      } catch (err) {\n        message.error(\"Failed to copy\");\n      }\n      document.body.removeChild(textArea);\n      return;\n    }\n    navigator.clipboard.writeText(text).then(\n      function () {\n        message.success(\"Link copied to clipboard!\");\n      },\n      () => {\n        message.error(\"Failed to copy\");\n      }\n    );\n  };\n\n  enumerateDevicesFunction = () => {\n    let select1 = document.getElementById(\"select1\");\n    let select3 = document.getElementById(\"select3\");\n\n    navigator.mediaDevices\n      .enumerateDevices()\n      .then(function (devices) {\n        devices.forEach(function (deviceInfo) {\n          var option = document.createElement(\"option\");\n          option.value = deviceInfo.deviceId;\n\n          if (deviceInfo.kind === \"audioinput\") {\n            console.log(deviceInfo.label);\n            option.label = deviceInfo.label;\n            option.value = deviceInfo.deviceId;\n\n            //  console.log(option.value);\n            \n            select1.appendChild(option);\n          } else if (deviceInfo.kind === \"videoinput\") {\n            option.label = deviceInfo.label;\n            option.value = deviceInfo.deviceId;\n            \n            //  console.log(option.value);\n           \n            select3.appendChild(option);\n          }\n        });\n      })\n      .catch(function (err) {\n        console.log(err.name + \": \" + err.message);\n      });\n  };\n\n  connect = () =>\n    this.setState({ askForUsername: false }, () => this.getMedia());\n\n  isChrome = function () {\n    let userAgent = (navigator && (navigator.userAgent || \"\")).toLowerCase();\n    let vendor = (navigator && (navigator.vendor || \"\")).toLowerCase();\n    let matchChrome = /google inc/.test(vendor)\n      ? userAgent.match(/(?:chrome|crios)\\/(\\d+)/)\n      : null;\n    // let matchFirefox = userAgent.match(/(?:firefox|fxios)\\/(\\d+)/)\n    // return matchChrome !== null || matchFirefox !== null\n    return matchChrome !== null;\n  };\n\n  render() {\n    if (this.isChrome() === false) {\n      return (\n        <div\n          style={{\n            background: \"white\",\n            width: \"30%\",\n            height: \"auto\",\n            padding: \"20px\",\n            minWidth: \"400px\",\n            textAlign: \"center\",\n            margin: \"auto\",\n            marginTop: \"50px\",\n            justifyContent: \"center\",\n          }}\n        >\n          <h1>Sorry, this works only with Google Chrome</h1>\n        </div>\n      );\n    }\n    return (\n      <div>\n        {this.state.askForUsername === true ? (\n          <div>\n            <div\n              style={{\n                background: \"white\",\n                width: \"30%\",\n                height: \"auto\",\n                padding: \"20px\",\n                minWidth: \"400px\",\n                textAlign: \"center\",\n                margin: \"auto\",\n                marginTop: \"50px\",\n                justifyContent: \"center\",\n              }}\n            >\n              <p\n                style={{ margin: 0, fontWeight: \"bold\", paddingRight: \"50px\" }}\n              >\n                Set your username\n              </p>\n              <Input\n                placeholder=\"Username\"\n                required\n                value={this.state.username}\n                onChange={(e) => this.handleUsername(e)}\n              />\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={this.connect}\n                disabled={!this.state.username}\n                style={{ margin: \"20px\" }}\n              >\n                Connect\n              </Button>\n            </div>\n            <div\n              style={{\n                justifyContent: \"center\",\n                textAlign: \"center\",\n                paddingTop: \"40px\",\n              }}\n            >\n              <video\n                id=\"my-video\"\n                ref={this.localVideoref}\n                autoPlay\n                muted\n                style={{\n                  borderStyle: \"solid\",\n                  borderColor: \"#bdbdbd\",\n                  objectFit: \"fill\",\n                  width: \"60%\",\n                  height: \"30%\",\n                }}\n              ></video>\n            </div>\n          </div>\n        ) : (\n          <div>\n            <div\n              className=\"btn-down\"\n              style={{\n                backgroundColor: \"whitesmoke\",\n                color: \"whitesmoke\",\n                textAlign: \"center\",\n              }}\n            >\n              <IconButton\n                style={{ color: \"#424242\" }}\n                onClick={this.handleVideo}\n              >\n                {this.state.video === true ? (\n                  <VideocamIcon />\n                ) : (\n                  <VideocamOffIcon />\n                )}\n              </IconButton>\n\n              <IconButton\n                style={{ color: \"#f44336\" }}\n                onClick={this.handleEndCall}\n              >\n                <CallEndIcon />\n              </IconButton>\n\n              <IconButton\n                style={{ color: \"#424242\" }}\n                onClick={this.handleAudio}\n              >\n                {this.state.audio === true ? <MicIcon /> : <MicOffIcon />}\n              </IconButton>\n\n              {this.state.screenAvailable === true ? (\n                <IconButton\n                  style={{ color: \"#424242\" }}\n                  onClick={this.handleScreen}\n                >\n                  {this.state.screen === true ? (\n                    <ScreenShareIcon />\n                  ) : (\n                    <StopScreenShareIcon />\n                  )}\n                </IconButton>\n              ) : null}\n\n              <Badge\n                badgeContent={this.state.newmessages}\n                max={999}\n                color=\"secondary\"\n                onClick={this.openChat}\n              >\n                <IconButton\n                  style={{ color: \"#424242\" }}\n                  onClick={this.openChat}\n                >\n                  <ChatIcon />\n                </IconButton>\n              </Badge>\n            </div>\n\n            <Modal\n              show={this.state.showModal}\n              onHide={this.closeChat}\n              style={{ zIndex: \"999999\" }}\n            >\n              <Modal.Header closeButton>\n                <Modal.Title>Chat Room</Modal.Title>\n              </Modal.Header>\n              <Modal.Body\n                style={{\n                  overflow: \"auto\",\n                  overflowY: \"auto\",\n                  height: \"400px\",\n                  textAlign: \"left\",\n                }}\n              >\n                {this.state.messages.length > 0 ? (\n                  this.state.messages.map((item, index) => (\n                    <div key={index} style={{ textAlign: \"left\" }}>\n                      <p style={{ wordBreak: \"break-all\" }}>\n                        <b>{item.sender}</b>: {item.data}\n                      </p>\n                    </div>\n                  ))\n                ) : (\n                  <p>No messages yet</p>\n                )}\n              </Modal.Body>\n              <Modal.Footer className=\"div-send-msg\">\n                <Input\n                  placeholder=\"Message\"\n                  value={this.state.message}\n                  onChange={(e) => this.handleMessage(e)}\n                />\n                <Button\n                  variant=\"contained\"\n                  color=\"primary\"\n                  onClick={this.sendMessage}\n                >\n                  Send\n                </Button>\n              </Modal.Footer>\n            </Modal>\n\n            <div className=\"container\">\n              <div style={{ paddingTop: \"20px\" }}>\n                <Input value={window.location.href} disable=\"true\"></Input>\n                <Button\n                  style={{\n                    backgroundColor: \"#3f51b5\",\n                    color: \"whitesmoke\",\n                    marginLeft: \"20px\",\n                    marginTop: \"10px\",\n                    width: \"120px\",\n                    fontSize: \"10px\",\n                  }}\n                  onClick={this.copyUrl}\n                >\n                  Copy invite link\n                </Button>{\" \"}\n                <br />\n              </div>\n\n              <div className=\"pt-4 pb-4\">\n              <div>\n                <label for=\"select1\">Audio Source: </label>\n                <select id=\"select1\" className=\"pr-3\">\n                </select>\n              </div>\n              <div>\n                <label for=\"select3\">Video Source: </label>\n                <select id=\"select3\" className=\"pr-3\">\n                </select>\n                {this.enumerateDevicesFunction()}\n              </div>\n              </div>\n\n              <Row\n                id=\"main\"\n                className=\"flex-container\"\n                style={{ margin: 0, padding: 0 }}\n              >\n                <video\n                  id=\"my-video\"\n                  ref={this.localVideoref}\n                  autoPlay\n                  muted\n                  style={{\n                    borderStyle: \"solid\",\n                    borderColor: \"#bdbdbd\",\n                    margin: \"10px\",\n                    objectFit: \"fill\",\n                    width: \"100%\",\n                    height: \"100%\",\n                  }}\n                ></video>\n              </Row>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Room;\n"]},"metadata":{},"sourceType":"module"}